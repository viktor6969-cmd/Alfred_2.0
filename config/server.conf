# =====================================================
# Server Automation Main Config
# =====================================================

[global]
MASTER_IP=203.0.113.7
SSH_PORT_BOOTSTRAP=22
SSH_PORT_FINAL=22

[user]
DEFAULT_USER="ubuntu"
NEW_USERNAME="name"
ROOT_PASSWORD="password"

[ufw]
DEFAULT_INCOMING=deny
DEFAULT_OUTGOING=allow
ALLOW_SERVICES=ssh,https
PACKAGES="ufw fail2ban knockd"

[ssh.bootstrap]
Port = {{SSH_PORT_BOOTSTRAP}}
PermitRootLogin = yes
PasswordAuthentication = yes

[ssh.secure]
Port = {{SSH_PORT_FINAL}}
PermitRootLogin = no
PasswordAuthentication = no

[ufw.profile.Nginx]
title=Web Server
description=NGINX web server ports
ports=80/tcp,443/tcp,8080/tcp,8443/tcp

[ufw.profile.SSH-Custom]
title=SSH Custom Port
description=SSH on port {{SSH_PORT_BOOTSTRAP}}
ports={{SSH_PORT_BOOTSTRAP}}/tcp

[ufw.profile.VPN]
title=WireGuard VPN
description=WireGuard VPN ports
ports=51820/udp,1194/udp

[knockd.profile.SSH]
sequence=7000,8000,9000
seq_timeout=10
command=ufw allow from %IP% to any app SSH-Custom
tcpflags=syn
cmd_timeout=300
stop_command=ufw delete allow from %IP% to any app SSH-Custom

[knockd.profile.VPN]
sequence=1000,2000,3000
seq_timeout=10
command=ufw allow from %IP% to any app VPN
tcpflags=syn
cmd_timeout=300
stop_command=ufw delete allow from %IP% to any app VPN
